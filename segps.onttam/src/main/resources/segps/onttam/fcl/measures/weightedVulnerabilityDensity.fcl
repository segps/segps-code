/*
 * FCL file for the Weighted Vulnerability Density measure
 */
FUNCTION_BLOCK WVD

VAR_INPUT
	WVD_Measure: REAL;
	WVD_Weight: REAL;
END_VAR

VAR_OUTPUT
	WVD_Score: REAL;
END_VAR

FUZZIFY WVD_Measure
	TERM VERYLOW := (0.0,1.0) (1.04,1.0) (2.11,0.0) ;
	TERM LOW := (1.90,0.0) (2.975,1.0) (4.14,0.0) ;
	TERM AVERAGE := (3.73,0.0) (4.91,1.0) (6.17,0.0) ;
	TERM HIGH := (5.55,0.0) (6.845,1.0) (8.20,0.0) ;
	TERM VERYHIGH := (7.38,0.0) (8.78,1.0) (11.29,1.0) ;
END_FUZZIFY

FUZZIFY WVD_Weight
	TERM LOW := (0.0,1.0) (0.5,1.0) (2.69,0.0) ;
	TERM MEDIUM := (2.56,0.0) (4.75,1.0) (7.05,0.0) ;
	TERM HIGH := (6.69,0.0) (9.0,1.0) (12.0,1.0) ;
END_FUZZIFY

DEFUZZIFY WVD_Score
	TERM VERYPOOR := (6.5,0.0) (7.5,1.0) (9.0,1.0) ;
	TERM POOR := (5.31,0.0) (6.25,1.0) (7.22,0.0) ;
	TERM AVERAGE := (4.14,0.0) (5.0,1.0) (5.9,0.0) ;
	TERM VERYGOOD := (2.95,0.0) (3.75,1.0) (4.6,0.0) ;
	TERM EXCELLENT := (0.0,1.0) (2.5,1.0) (3.28,0.0) ;
	METHOD : COG;
END_DEFUZZIFY

RULEBLOCK WVD_SCORE_RULES
	RULE 0 : IF WVD_Measure IS VERYLOW AND WVD_Weight IS LOW THEN WVD_Score IS EXCELLENT ;
	RULE 1 : IF WVD_Measure IS VERYLOW AND WVD_Weight IS MEDIUM THEN WVD_Score IS EXCELLENT ;
	RULE 2 : IF WVD_Measure IS VERYLOW AND WVD_Weight IS HIGH THEN WVD_Score IS VERYGOOD ;
	
	RULE 3 : IF WVD_Measure IS LOW AND WVD_Weight IS LOW THEN WVD_Score IS EXCELLENT ;
	RULE 4 : IF WVD_Measure IS LOW AND WVD_Weight IS MEDIUM THEN WVD_Score IS VERYGOOD ;
	RULE 5 : IF WVD_Measure IS LOW AND WVD_Weight IS HIGH THEN WVD_Score IS AVERAGE ;
	
	RULE 6 : IF WVD_Measure IS AVERAGE AND WVD_Weight IS LOW THEN WVD_Score IS VERYGOOD ;
	RULE 7 : IF WVD_Measure IS AVERAGE AND WVD_Weight IS MEDIUM THEN WVD_Score IS AVERAGE ;
	RULE 8 : IF WVD_Measure IS AVERAGE AND WVD_Weight IS HIGH THEN WVD_Score IS POOR;
	
	RULE 9 : IF WVD_Measure IS HIGH AND WVD_Weight IS LOW THEN WVD_Score IS AVERAGE ;
	RULE 10 : IF WVD_Measure IS HIGH AND WVD_Weight IS MEDIUM THEN WVD_Score IS POOR ;
	RULE 11 : IF WVD_Measure IS HIGH AND WVD_Weight IS HIGH THEN WVD_Score IS  VERYPOOR;
	
	RULE 12 : IF WVD_Measure IS VERYHIGH AND WVD_Weight IS LOW THEN WVD_Score IS POOR ;
	RULE 13 : IF WVD_Measure IS VERYHIGH AND WVD_Weight IS MEDIUM THEN WVD_Score IS VERYPOOR ;
	RULE 14 : IF WVD_Measure IS VERYHIGH AND WVD_Weight IS HIGH THEN WVD_Score IS VERYPOOR ;
END_RULEBLOCK

END_FUNCTION_BLOCK
